# 実装計画: ダッシュボード

**ブランチ**: `[002-dashboard-feature]` | **日付**: 2025-09-13 | **仕様書**: [/home/saki/github/specDrivenDevelopmentSample/specs/002-dashboard-feature/spec.md]  
**入力**: `/specs/002-dashboard-feature/spec.md` の機能仕様

## 実行フロー (/plan コマンド範囲)
```
1. 入力パスから仕様書を読み込む
   → 見つからない場合: ERROR "仕様書が {path} にありません"
2. 技術コンテキストを記入（NEEDS CLARIFICATION を抽出）
   → プロジェクトタイプを文脈から判定（web=フロント+バック、mobile=アプリ+API）
   → 構造方針をプロジェクトタイプに基づき決定
3. 憲法チェックセクションを評価
   → 違反があれば複雑性トラッキングに記載
   → 正当化できない場合: ERROR "まずアプローチを簡素化してください"
   → 進捗トラッキング: 初期憲法チェック
4. フェーズ0 → research.md を実行
   → NEEDS CLARIFICATION が残っていれば: ERROR "不明点を解決してください"
5. フェーズ1 → contracts, data-model.md, quickstart.md, エージェント用テンプレートファイルを作成
6. 憲法チェックセクションを再評価
   → 新たな違反があれば設計をリファクタしフェーズ1に戻る
   → 進捗トラッキング: 設計後憲法チェック
7. フェーズ2 → タスク生成アプローチを記述（tasks.mdは作成しない）
8. STOP - /tasks コマンドの準備完了
```

## サマリー
本機能は、ユーザーがブラウザ上でダッシュボード画面を開き、複数の情報（タスク進捗、統計、通知など）を一目で確認できるようにします。グラフ表示にはChartJSを使用します。

## 技術コンテキスト
**言語/バージョン**: JavaScript (ES2021+), HTML5, CSS3  
**主な依存関係**: ChartJS  
**データ保存**: [NEEDS CLARIFICATION: 永続化方法（LocalStorage、サーバー等）]  
**テスト**: [NEEDS CLARIFICATION: テストフレームワーク（例：Jest, Mocha, なし）]  
**対象プラットフォーム**: ブラウザ（PC/スマホ）  
**プロジェクトタイプ**: web（フロントエンドのみ）  
**パフォーマンス目標**: 1秒以内ロード、グラフ描画は100ms以内  
**制約**: ChartJS利用、HTML5準拠  
**規模/スコープ**: 複数ウィジェット・グラフ表示（[NEEDS CLARIFICATION: ウィジェット数・種類]）

## 憲法チェック

**シンプルさ**:
- プロジェクト数: 1（フロントエンドのみ）
- ChartJS直接利用
- 単一データモデル？ [NEEDS CLARIFICATION: ウィジェット・ユーザー・通知のみか]
- 設計パターン回避？ YES（複雑な設計パターン禁止）

**アーキテクチャ**:
- 全機能をライブラリ化？ YES（ダッシュボードロジックはモジュール化）
- 使用ライブラリ一覧: ChartJS
- CLI per library: 該当なし
- ライブラリドキュメント: llms.txt形式予定？ [NEEDS CLARIFICATION]

**テスト（必須）**:
- RED-GREEN-リファクタサイクル厳守？ [NEEDS CLARIFICATION: テスト方針]
- Gitコミットはテスト→実装順？ YES（TDD推奨）
- 順序: コントラクト→統合→E2E→ユニット厳守？ YES
- 実際の依存関係使用？ YES（ChartJS, ブラウザAPI）
- 統合テスト: 新規ライブラリ、コントラクト変更、共有スキーマ？ YES
- 禁止: 実装先行、REDフェーズ省略

**可観測性**:
- 構造化ログ含む？ [NEEDS CLARIFICATION: ログ出力要否]
- フロントログ→バックエンド？ 該当なし
- エラー文脈十分？ YES

**バージョニング**:
- バージョン番号付与？ MAJOR.MINOR.BUILD（例：1.0.0）
- BUILDは変更ごとに増加？ YES
- 破壊的変更対応？ YES（互換性維持）

## プロジェクト構成

### ドキュメント（本機能）
```
specs/002-dashboard-feature/
├── plan.md
├── research.md
├── data-model.md
├── quickstart.md
├── contracts/
└── tasks.md
```

### ソースコード（リポジトリルート）
```
src/
├── models/
├── services/
├── components/
└── lib/
tests/
├── contract/
├── integration/
└── unit/
```

**構造方針**: フロントエンドのみ（src/、tests/）

## フェーズ0: アウトライン＆リサーチ
1. **技術コンテキストから不明点抽出**:
   - 永続化方法（LocalStorage、サーバー等）
   - テストフレームワーク選定
   - ウィジェット数・種類
   - ログ出力要否
   - llms.txtドキュメント要否

2. **リサーチエージェント生成・実行**:
   ```
   タスク: "ChartJSを使ったダッシュボードグラフ表示のベストプラクティスを調査"
   タスク: "ダッシュボード情報の永続化方法（LocalStorage等）を調査"
   タスク: "PC/スマホ対応のUI設計を調査"
   タスク: "テストフレームワーク（Jest, Mocha, なし）を調査"
   タスク: "ログ出力要否と方法を調査"
   タスク: "ウィジェット数・種類のベストプラクティスを調査"
   ```

3. **research.md に調査結果を統合**:
   - 決定事項: [選択内容]
   - 根拠: [選択理由]
   - 他の選択肢: [比較検討内容]

**成果物**: research.md（全NEEDS CLARIFICATION解消済み）

## フェーズ1: 設計＆コントラクト
*前提: research.md 完了*

1. **仕様書からエンティティ抽出 → data-model.md**:
   - エンティティ名、フィールド、関係性
   - 要件からバリデーションルール
   - 状態遷移（該当時）

2. **機能要件からAPIコントラクト生成**:
   - 該当なし（API不要、ローカル保存のみの場合）

3. **コントラクトテスト生成**:
   - 該当なし（API不要）

4. **ユーザーストーリーからテストシナリオ抽出**:
   - ダッシュボード表示・ウィジェット操作・グラフ描画・情報永続化

5. **エージェントファイルを随時更新**（O(1)操作）:
   - `/specify/scripts/bash/update-agent-context.sh copilot` を実行

**成果物**: data-model.md, quickstart.md, テスト（失敗状態）, エージェント用ファイル

## フェーズ2: タスク計画アプローチ
*このセクションは /tasks コマンドで実行。ここでは記述のみ*

**タスク生成方針**:
- `/templates/tasks-template.md` をベースにロード
- フェーズ1設計ドキュメント（data model, quickstart）からタスク生成
- 各エンティティ → モデル作成タスク [P]
- 各ユーザーストーリー → 統合テストタスク
- テスト合格のための実装タスク

**順序方針**:
- TDD順: テスト→実装
- 依存順: モデル→サービス→UI
- [P]は並列実行可能（独立ファイル）

**推定タスク数**: 20～30件（tasks.md）

**重要**: このフェーズは /tasks コマンドで実行。/plan では実行しない

## フェーズ3以降: 実装以降
*これ以降は /plan コマンドの範囲外*

**フェーズ3**: タスク実行（/tasks コマンドで tasks.md 作成）  
**フェーズ4**: 実装（tasks.md に従い憲法原則を守って実装）  
**フェーズ5**: 検証（テスト実行、quickstart.md 実行、パフォーマンス検証）

## 複雑性トラッキング
*憲法チェック違反がある場合のみ記入*

| 違反内容 | 必要理由 | 却下した簡易案 |
|----------|----------|----------------|
| なし     |          |                |

## 進捗トラッキング
*実行フローに応じて更新*

**フェーズ進捗**:
- [x] フェーズ0: リサーチ完了 (/plan コマンド)
- [ ] フェーズ1: 設計完了 (/plan コマンド)
- [ ] フェーズ2: タスク計画完了 (/plan コマンド・記述のみ)
- [ ] フェーズ3: タスク生成済み (/tasks コマンド)
- [ ] フェーズ4: 実装完了
- [ ] フェーズ5: 検証完了

**ゲート進捗**:
- [x] 初期憲法チェック: 合格
- [ ] 設計後憲法チェック: 合格
- [ ] 全NEEDS CLARIFICATION解消済み
- [ ] 複雑性逸脱記録済み

---
*憲法 v2.1.1 に基づく - `/memory/constitution.md` を参照